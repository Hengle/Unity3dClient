---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by asus.
--- DateTime: 2018/4/8 11:25
---
local AccountSelectFrame = {}
local maxAccountCount = 6
local accountArray = {'nice','fuck','shenshaojun','wangzhe','dingjiaming'}

AccountSelectFrame.accountList = nil

function AccountSelectFrame.OnOpenFrame()
    --self.accountHistory = AccountUtils.readAccountHistory()

    self.frame:GetObject('btn_login_other').onClick:AddListener(AccountSelectFrame.onClickLoginOther)
    self.frame:GetObject('btn_register').onClick:AddListener(AccountSelectFrame.onClickRegister)
    self.frame:GetObject('btn_back').onClick:AddListener(AccountSelectFrame.onClickBack)
    self.frame:GetObject('btn_login').onClick:AddListener(AccountSelectFrame.onClickLogin)

    self.accountList = self.frame:GetObject('svw_account_list')
    if self.accountList then
        self.accountList:Initialize()
        local accountCount = ((#accountArray > maxAccountCount) and {maxAccountCount} or {#accountArray})[1]
        print("accountCount", accountCount)
        self.accountList:SetElementAmount(accountCount)
        self.accountList.mOnListElementVisible = function(index,binder)

            if index >= 0 and index < accountCount then
                binder:GetObject('txt_account_name').text = accountArray[index + 1]
                binder:GetObject('btn_delete').onClick:RemoveListener(AccountSelectFrame.onClickDeleteAccount)
                binder:GetObject('btn_delete').onClick:AddListener(AccountSelectFrame.onClickDeleteAccount)
            end
        end

        self.accountList.mOnListElementChangeDisplay = function(elementIndex, binder, bSelected)
            self.frame:SetObjectStatus(binder,bSelected)
        end

        --[[accountList.mOnListElementChangeDisplay = function(elementIndex, binder, bSelected)
            binder:GetObject('accountName'):CustomActive(bSelected)
        end]]--
    end
end

AccountSelectFrame.onClickLoginOther = function()
    app.FrameManager.OpenFrameLua(app._FrameList.AccountLoginFrame)
end

AccountSelectFrame.onClickRegister = function()
    app.FrameManager.OpenFrameLua(app._FrameList.AccountRegisterFrame)
end

AccountSelectFrame.onClickBack = function()
    app.FrameManager.CloseFrame(self.frame)
end

AccountSelectFrame.onClickLogin = function()
    --TODO 回传选定的账号给LoginFrame 并登录
end

AccountSelectFrame.onClickDeleteAccount = function()
    print("click callback invoked")
end

function AccountSelectFrame.OnCloseFrame()

end

-- ---------------------显示控制接口AccountSelectPresenter调用--------------------------------


return AccountSelectFrame