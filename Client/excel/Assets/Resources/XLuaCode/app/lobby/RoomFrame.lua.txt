---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by asus.
--- DateTime: 2018/4/17 9:28
---
local RoomFrame = {}

local RoomConfig = require(".app.config.RoomConfig")

local UserMessage = require(".net.UserMessage")

local roomMgr = require(".app.room.RoomManager")

local Gameid_fish = 110

local barFrame = nil

function RoomFrame.OnOpenFrame()
    local attachNode = self.frame:GetObject('pnl_bar_frame')
    barFrame = app.FrameManager.OpenFrameLua(app._FrameList.BarFrame,nil,-1,attachNode)
    self.frame:AddChildFrame(barFrame)

    local gameConfig = RoomConfig:getGameConfig(Gameid_fish)
    dump(gameConfig, "RoomFrame.OnOpenFrame:")
    assert(gameConfig)

    local roomid = 11000
    roomMgr:init(Gameid_fish, roomid)
    UserMessage.send("EnterRoomReq", {roomid=roomid}, function(msg)
        roomMgr:EnterRoomRep(msg)
    end)

    for _,config in ipairs(gameConfig.room) do
        dump(config, "config")
        local roomid = (config.roomid) % 100 + 1
        self.frame:GetObject("btn_room_"..roomid).onClick:AddListener(function()
        roomMgr:init(Gameid_fish,config.roomid)
        UserMessage.send("EnterRoomReq", {roomid=config.roomid}, function(msg)
            roomMgr:EnterRoomRep(msg)
        end)
    end)
    end
end

RoomFrame.onClickRoom1 = function()
    local roomid = 11000
    roomMgr:init(Gameid_fish, roomid)
    UserMessage.send("EnterRoomReq", {roomid=roomid}, function(msg)
        roomMgr:EnterRoomRep(msg)
    end)
end

function RoomFrame.OnCloseFrame()
    barFrame = nil
end

return RoomFrame