---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by asus.
--- DateTime: 2018/4/15 19:22
---
local RoomManager = {}

local message = require(".net.Message")

local msgMgr = require(".app.room.RoomMsgManager")

local function loadGameScene(gameid, roomid)
    print("loadGameScene name")
    if gameid == nil or roomid == nil then
        print("gameid or roomid is nil.")
        return
    end
    local config = require(".app.config.RoomConfig")
    assert(config, "config is nil")
    for i = 1, #config do
        if config[i].gameid == gameid then
            for j = 1, #config[i].room do
                if config[i].room[j].roomid == roomid then
                    print("set game scene:", config[i].scene)
                    msgMgr:setGameName(config[i].scene)
                    msgMgr:setMaxPlayer(config[i].room[j].seats, config[i].room[j].seatslayout)
                    if config[i].room[j].gamekey ~= nil then
                        msgMgr:setGameKey(config[i].room[j].gamekey)
                    else
                        msgMgr:setGameKey("")
                    end
                    return
                end
            end
        end
    end
end

function RoomManager:init(gameId, roomId)
    msgMgr:setRoomId(gameId, roomId)
    loadGameScene(gameId, roomId)
    message.registerHandle("game", handler(msgMgr, msgMgr.dispatch))
end

function RoomManager:EnterRoomRep(msg)
    msgMgr:EnterRoomRep(msg)
end

return RoomManager